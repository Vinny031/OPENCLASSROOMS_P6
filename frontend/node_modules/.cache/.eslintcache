[{"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\index.js":"1","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\reportWebVitals.js":"2","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\App.jsx":"3","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\lib\\customHooks.js":"4","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\utils\\constants.js":"5","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\pages\\Home\\Home.jsx":"6","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\pages\\SignIn\\SignIn.jsx":"7","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\pages\\updateBook\\UpdateBook.jsx":"8","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\pages\\Book\\Book.jsx":"9","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\pages\\AddBook\\AddBook.jsx":"10","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\ScrollToTop\\ScrollToTop.jsx":"11","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Header\\Header.jsx":"12","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Footer\\Footer.jsx":"13","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\lib\\common.js":"14","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\BackArrow\\BackArrow.jsx":"15","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Books\\BookItem\\BookItem.jsx":"16","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Books\\BookForm\\BookForm.jsx":"17","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Books\\BookInfo\\BookInfo.jsx":"18","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Books\\BestRatedBooks\\BestRatedBooks.jsx":"19","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Books\\BookRatingForm\\BookRatingForm.jsx":"20","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\lib\\functions.jsx":"21"},{"size":613,"mtime":1740394667132,"results":"22","hashOfConfig":"23"},{"size":390,"mtime":1740394667139,"results":"24","hashOfConfig":"23"},{"size":1380,"mtime":1740503126057,"results":"25","hashOfConfig":"23"},{"size":1388,"mtime":1740394667133,"results":"26","hashOfConfig":"23"},{"size":417,"mtime":1740759176419,"results":"27","hashOfConfig":"23"},{"size":1422,"mtime":1740394667136,"results":"28","hashOfConfig":"23"},{"size":4495,"mtime":1740394667137,"results":"29","hashOfConfig":"23"},{"size":1811,"mtime":1740394667138,"results":"30","hashOfConfig":"23"},{"size":3874,"mtime":1740394667136,"results":"31","hashOfConfig":"23"},{"size":1443,"mtime":1740394667135,"results":"32","hashOfConfig":"23"},{"size":258,"mtime":1740394667123,"results":"33","hashOfConfig":"23"},{"size":1365,"mtime":1740394667123,"results":"34","hashOfConfig":"23"},{"size":931,"mtime":1740394667122,"results":"35","hashOfConfig":"23"},{"size":4418,"mtime":1740755547073,"results":"36","hashOfConfig":"23"},{"size":426,"mtime":1740394667117,"results":"37","hashOfConfig":"23"},{"size":1527,"mtime":1740394667120,"results":"38","hashOfConfig":"23"},{"size":4310,"mtime":1740394667118,"results":"39","hashOfConfig":"23"},{"size":1120,"mtime":1740394667119,"results":"40","hashOfConfig":"23"},{"size":726,"mtime":1740394667118,"results":"41","hashOfConfig":"23"},{"size":2119,"mtime":1740394667120,"results":"42","hashOfConfig":"23"},{"size":1717,"mtime":1740394667133,"results":"43","hashOfConfig":"23"},{"filePath":"44","messages":"45","suppressedMessages":"46","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"coz81r",{"filePath":"47","messages":"48","suppressedMessages":"49","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"50","messages":"51","suppressedMessages":"52","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"53","messages":"54","suppressedMessages":"55","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"56"},{"filePath":"57","messages":"58","suppressedMessages":"59","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"60","messages":"61","suppressedMessages":"62","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"63","messages":"64","suppressedMessages":"65","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"66","messages":"67","suppressedMessages":"68","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"69"},{"filePath":"70","messages":"71","suppressedMessages":"72","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"73"},{"filePath":"74","messages":"75","suppressedMessages":"76","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"77"},{"filePath":"78","messages":"79","suppressedMessages":"80","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"81","messages":"82","suppressedMessages":"83","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"84","messages":"85","suppressedMessages":"86","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"87","messages":"88","suppressedMessages":"89","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"90","messages":"91","suppressedMessages":"92","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"93","messages":"94","suppressedMessages":"95","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"96","messages":"97","suppressedMessages":"98","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"99"},{"filePath":"100","messages":"101","suppressedMessages":"102","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"103","messages":"104","suppressedMessages":"105","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"106","messages":"107","suppressedMessages":"108","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"109"},{"filePath":"110","messages":"111","suppressedMessages":"112","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\index.js",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\reportWebVitals.js",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\App.jsx",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\lib\\customHooks.js",["113","114"],[],"import { useState, useEffect } from 'react';\r\nimport { getAuthenticatedUser, getBestRatedBooks } from './common';\r\n\r\n// eslint-disable-next-line import/prefer-default-export\r\nexport function useUser() {\r\n  const [connectedUser, setConnectedUser] = useState(null);\r\n  const [auth, setAuth] = useState(false);\r\n  const [userLoading, setUserLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    async function getUserDetails() {\r\n      const { authenticated, user } = await getAuthenticatedUser();\r\n      setConnectedUser(user);\r\n      setAuth(authenticated);\r\n      setUserLoading(false);\r\n    }\r\n    getUserDetails();\r\n  }, []);\r\n\r\n  return { connectedUser, auth, userLoading };\r\n}\r\n\r\nexport function useBestRatedBooks() {\r\n  const [bestRatedBooks, setBestRatedBooks] = useState({});\r\n\r\n  useEffect(() => {\r\n    async function getRatedBooks() {\r\n      const books = await getBestRatedBooks();\r\n      setBestRatedBooks(books);\r\n    }\r\n    getRatedBooks();\r\n  }, []);\r\n\r\n  return { bestRatedBooks };\r\n}\r\n\r\nexport function useFilePreview(file) {\r\n  const fileInput = file[0] ?? [];\r\n  const [imgSrc, setImgSrc] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (file && file[0]?.length > 0) {\r\n      const newUrl = URL.createObjectURL(file[0][0]);\r\n\r\n      if (newUrl !== imgSrc) {\r\n        setImgSrc(newUrl);\r\n      }\r\n    }\r\n  }, [fileInput[0]?.name]);\r\n\r\n  return [imgSrc, setImgSrc];\r\n}\r\n","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\utils\\constants.js",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\pages\\Home\\Home.jsx",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\pages\\SignIn\\SignIn.jsx",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\pages\\updateBook\\UpdateBook.jsx",["115","116"],[],"import React, { useEffect, useState } from 'react';\r\nimport { Link, useNavigate, useParams } from 'react-router-dom';\r\nimport styles from './UpdateBook.module.css';\r\nimport BookForm from '../../components/Books/BookForm/BookForm';\r\nimport BackArrow from '../../components/BackArrow/BackArrow';\r\nimport { getBook } from '../../lib/common';\r\nimport { APP_ROUTES } from '../../utils/constants';\r\nimport { useUser } from '../../lib/customHooks';\r\nimport bookAdd from '../../images/book_add.jpg';\r\n\r\nfunction UpdateBook() {\r\n  const [book, setBook] = useState(null);\r\n  const params = useParams();\r\n  const navigate = useNavigate();\r\n  const { connectedUser, auth, userLoading } = useUser();\r\n  const [created, setCreated] = useState(false);\r\n  useEffect(() => {\r\n    if (!userLoading) {\r\n      if (!connectedUser || !auth) {\r\n        navigate(APP_ROUTES.SIGN_IN);\r\n      }\r\n    }\r\n  }, [userLoading]);\r\n  useEffect(() => {\r\n    async function getItem() {\r\n      const data = await getBook(params.id);\r\n      if (data) {\r\n        setBook(data);\r\n      }\r\n    }\r\n    getItem();\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"content-container\">\r\n      <BackArrow />\r\n      <div className={styles.Container}>\r\n        {!created ? (\r\n          <>\r\n            <h1>Modifier votre livre</h1>\r\n            <p>Vous pouvez modifier tous les champs sauf la note donnée</p>\r\n            <BookForm book={book} validate={setCreated} />\r\n          </>\r\n        ) : (\r\n          <div className={styles.Created}>\r\n            <h1>Merci!</h1>\r\n            <p>votre livre a bien été mis à jour</p>\r\n            <img src={bookAdd} alt=\"Livre mis à jour\" />\r\n            <Link to=\"/\" className=\"button\">Retour à l&apos;accueil</Link>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default UpdateBook;\r\n","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\pages\\Book\\Book.jsx",["117"],["118"],"/* eslint-disable react/jsx-props-no-spreading */\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useParams, Link } from 'react-router-dom';\r\nimport { useUser } from '../../lib/customHooks';\r\nimport styles from './Book.module.css';\r\nimport { getBook, deleteBook } from '../../lib/common';\r\nimport BookInfo from '../../components/Books/BookInfo/BookInfo';\r\nimport BookRatingForm from '../../components/Books/BookRatingForm/BookRatingForm';\r\nimport BookDeleteImage from '../../images/book_delete.png';\r\nimport BestRatedBooks from '../../components/Books/BestRatedBooks/BestRatedBooks';\r\nimport BackArrow from '../../components/BackArrow/BackArrow';\r\n\r\nfunction Book() {\r\n  const { connectedUser, userLoading } = useUser();\r\n  const [book, setBook] = useState(null);\r\n  const [rating, setRating] = useState(0);\r\n  const [userRated, setUserRated] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const params = useParams();\r\n\r\n  useEffect(() => {\r\n    async function getItem() {\r\n      const data = await getBook(params.id);\r\n      if (data) {\r\n        setBook(data);\r\n      }\r\n    }\r\n    getItem();\r\n  }, [params.id]);\r\n\r\n  useEffect(() => {\r\n    if (!userLoading && connectedUser && book?.title) {\r\n      const rate = book.ratings.find((elt) => elt.userId === connectedUser.userId);\r\n      if (rate) {\r\n        setUserRated(true);\r\n        setRating(parseInt(rate.grade, 10));\r\n        setLoading(false);\r\n      } else {\r\n        setUserRated(false);\r\n        setRating(0);\r\n        setLoading(false);\r\n      }\r\n    } else if (!userLoading && !connectedUser && book) {\r\n      setLoading(false);\r\n    }\r\n  }, [book, userLoading]);\r\n\r\n  const onDelete = async (e) => {\r\n    if (e.key && e.key !== 'Enter') {\r\n      return;\r\n    }\r\n    // eslint-disable-next-line no-restricted-globals\r\n    const check = confirm('Etes vous sûr de vouloir supprimer ce livre ?');\r\n    if (check) {\r\n      const del = await deleteBook(book.id);\r\n      if (del) {\r\n        setBook((oldValue) => ({ ...oldValue, delete: true }));\r\n      }\r\n    }\r\n  };\r\n\r\n  const loadingContent = (<h1>Chargement ...</h1>);\r\n\r\n  const bookContent = !loading && !book.delete ? (\r\n    <div>\r\n      <div className={styles.Book}>\r\n        <div className={styles.BookImage} style={{ backgroundImage: `url(\"${book.imageUrl}\")` }} />\r\n        <div className={styles.BookContent}>\r\n          {book?.userId === connectedUser?.userId ? (\r\n            <div className={styles.Owner}>\r\n              <p>Vous avez publié cet ouvrage, vous pouvez le :</p>\r\n              <p>\r\n                <Link to={`/livre/modifier/${book.id}`}>modifier</Link>\r\n                {' '}\r\n                <span tabIndex={0} role=\"button\" onKeyUp={onDelete} onClick={onDelete}>supprimer</span>\r\n                {' '}\r\n              </p>\r\n            </div>\r\n          ) : null}\r\n          <BookInfo book={book} />\r\n          <BookRatingForm\r\n            userRated={userRated}\r\n            userId={connectedUser?.userId}\r\n            rating={rating}\r\n            setRating={setRating}\r\n            setBook={setBook}\r\n            id={book.id}\r\n          />\r\n        </div>\r\n      </div>\r\n      <hr />\r\n      <BestRatedBooks />\r\n    </div>\r\n  ) : null;\r\n  const deletedContent = book?.delete ? (\r\n    <div className={styles.Deleted}>\r\n      <h1>{book.title}</h1>\r\n      <p>a bien été supprimé</p>\r\n      <img src={BookDeleteImage} alt={`Le livre ${book.title} a bien été supprimé`} />\r\n      <Link to=\"/\">\r\n        <button type=\"button\">{'Retour à l\\'accueil'}</button>\r\n      </Link>\r\n    </div>\r\n  ) : null;\r\n\r\n  return (\r\n    <div className=\"content-container\">\r\n      <BackArrow />\r\n      {loading ? loadingContent : null}\r\n      <div className={styles.BookContainer}>\r\n        {bookContent}\r\n      </div>\r\n      {book?.delete ? deletedContent : null}\r\n\r\n    </div>\r\n  );\r\n}\r\nexport default Book;\r\n","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\pages\\AddBook\\AddBook.jsx",["119"],[],"import React, { useEffect, useState } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport styles from './AddBook.module.css';\r\nimport BookForm from '../../components/Books/BookForm/BookForm';\r\nimport BackArrow from '../../components/BackArrow/BackArrow';\r\nimport { useUser } from '../../lib/customHooks';\r\nimport { APP_ROUTES } from '../../utils/constants';\r\nimport bookAdd from '../../images/book_add.jpg';\r\n\r\nfunction AddBook() {\r\n  const navigate = useNavigate();\r\n  const { connectedUser, auth, userLoading } = useUser();\r\n  const [created, setCreated] = useState(false);\r\n  useEffect(() => {\r\n    if (!userLoading) {\r\n      if (!connectedUser || !auth) {\r\n        navigate(APP_ROUTES.SIGN_IN);\r\n      }\r\n    }\r\n  }, [userLoading]);\r\n\r\n  return (\r\n    <div className=\"content-container\">\r\n      <BackArrow />\r\n      <div className={styles.Container}>\r\n        {!created ? (\r\n          <>\r\n            <h1>Ajouter un livre</h1>\r\n            <p>tous les champs sont obligatoires</p>\r\n            <BookForm validate={setCreated} />\r\n          </>\r\n        ) : (\r\n          <div className={styles.Created}>\r\n            <h1>Merci!</h1>\r\n            <p>votre livre a bien été publié</p>\r\n            <img src={bookAdd} alt=\"Livre ajouté\" />\r\n            <Link to=\"/\" className=\"button\">Retour à l&apos;accueil</Link>\r\n          </div>\r\n\r\n        )}\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AddBook;\r\n","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\ScrollToTop\\ScrollToTop.jsx",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Header\\Header.jsx",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Footer\\Footer.jsx",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\lib\\common.js",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\BackArrow\\BackArrow.jsx",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Books\\BookItem\\BookItem.jsx",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Books\\BookForm\\BookForm.jsx",["120","121"],[],"/* eslint-disable react/jsx-props-no-spreading */\r\nimport React, { useEffect, useMemo, useState } from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport * as PropTypes from 'prop-types';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { generateStarsInputs } from '../../../lib/functions';\r\nimport { useFilePreview } from '../../../lib/customHooks';\r\nimport addFileIMG from '../../../images/add_file.png';\r\nimport styles from './BookForm.module.css';\r\nimport { updateBook, addBook } from '../../../lib/common';\r\n\r\nfunction BookForm({ book, validate }) {\r\n  const userRating = book ? book.ratings.find((elt) => elt.userId === localStorage.getItem('userId'))?.grade : 0;\r\n\r\n  const [rating, setRating] = useState(0);\r\n\r\n  const navigate = useNavigate();\r\n  const {\r\n    register, watch, formState, handleSubmit, reset,\r\n  } = useForm({\r\n    defaultValues: useMemo(() => ({\r\n      title: book?.title,\r\n      author: book?.author,\r\n      year: book?.year,\r\n      genre: book?.genre,\r\n    }), [book]),\r\n  });\r\n  useEffect(() => {\r\n    reset(book);\r\n  }, [book]);\r\n  const file = watch(['file']);\r\n  const [filePreview] = useFilePreview(file);\r\n\r\n  useEffect(() => {\r\n    setRating(userRating);\r\n  }, [userRating]);\r\n\r\n  useEffect(() => {\r\n    if (!book && formState.dirtyFields.rating) {\r\n      const rate = document.querySelector('input[name=\"rating\"]:checked').value;\r\n      setRating(parseInt(rate, 10));\r\n      formState.dirtyFields.rating = false;\r\n    }\r\n  }, [formState]);\r\n\r\n  const onSubmit = async (data) => {\r\n    // When we create a new book\r\n    if (!book) {\r\n      if (!data.file[0]) {\r\n        alert('Vous devez ajouter une image');\r\n      }\r\n      if (!data.rating) {\r\n        /* eslint-disable no-param-reassign */\r\n        data.rating = 0;\r\n        /* eslint-enable no-param-reassign */\r\n      }\r\n      const newBook = await addBook(data);\r\n      if (!newBook.error) {\r\n        validate(true);\r\n      } else {\r\n        alert(newBook.message);\r\n      }\r\n    } else {\r\n      const updatedBook = await updateBook(data, data.id);\r\n      if (!updatedBook.error) {\r\n        navigate('/');\r\n      } else {\r\n        alert(updatedBook.message);\r\n      }\r\n    }\r\n  };\r\n\r\n  const readOnlyStars = !!book;\r\n  return (\r\n    <form onSubmit={handleSubmit(onSubmit)} className={styles.Form}>\r\n      <input type=\"hidden\" id=\"id\" {...register('id')} />\r\n      <label htmlFor=\"title\">\r\n        <p>Titre du livre</p>\r\n        <input type=\"text\" id=\"title\" {...register('title')} />\r\n      </label>\r\n      <label htmlFor=\"author\">\r\n        <p>Auteur</p>\r\n        <input type=\"text\" id=\"author\" {...register('author')} />\r\n      </label>\r\n      <label htmlFor=\"year\">\r\n        <p>Année de publication</p>\r\n        <input type=\"text\" id=\"year\" {...register('year')} />\r\n      </label>\r\n      <label htmlFor=\"genre\">\r\n        <p>Genre</p>\r\n        <input type=\"text\" id=\"genre\" {...register('genre')} />\r\n      </label>\r\n      <label htmlFor=\"rate\">\r\n        <p>Note</p>\r\n        <div className={styles.Stars}>\r\n          {generateStarsInputs(rating, register, readOnlyStars)}\r\n        </div>\r\n      </label>\r\n      <label htmlFor=\"file\">\r\n        <p>Visuel</p>\r\n        <div className={styles.AddImage}>\r\n          {filePreview || book?.imageUrl ? (\r\n            <>\r\n              <img src={filePreview ?? book?.imageUrl} alt=\"preview\" />\r\n              <p>Modifier</p>\r\n            </>\r\n          ) : (\r\n            <>\r\n              <img src={addFileIMG} alt=\"Add file\" />\r\n              <p>Ajouter une image</p>\r\n            </>\r\n          )}\r\n\r\n        </div>\r\n        <input {...register('file')} type=\"file\" id=\"file\" />\r\n      </label>\r\n      <button type=\"submit\">Publier</button>\r\n    </form>\r\n  );\r\n}\r\n\r\nBookForm.propTypes = {\r\n  book: PropTypes.shape({\r\n    id: PropTypes.string,\r\n    _id: PropTypes.string,\r\n    userId: PropTypes.string,\r\n    title: PropTypes.string,\r\n    author: PropTypes.string,\r\n    year: PropTypes.number,\r\n    imageUrl: PropTypes.string,\r\n    genre: PropTypes.string,\r\n    ratings: PropTypes.arrayOf(PropTypes.shape({\r\n      userId: PropTypes.string,\r\n      grade: PropTypes.number,\r\n    })),\r\n    averageRating: PropTypes.number,\r\n  }),\r\n  validate: PropTypes.func,\r\n};\r\n\r\nBookForm.defaultProps = {\r\n  book: null,\r\n  validate: null,\r\n};\r\nexport default BookForm;\r\n","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Books\\BookInfo\\BookInfo.jsx",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Books\\BestRatedBooks\\BestRatedBooks.jsx",[],[],"C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\components\\Books\\BookRatingForm\\BookRatingForm.jsx",["122"],[],"import * as PropTypes from 'prop-types';\r\nimport React, { useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useForm } from 'react-hook-form';\r\nimport styles from './BookRatingForm.module.css';\r\nimport { generateStarsInputs, displayStars } from '../../../lib/functions';\r\nimport { APP_ROUTES } from '../../../utils/constants';\r\nimport { useUser } from '../../../lib/customHooks';\r\nimport { rateBook } from '../../../lib/common';\r\n\r\nfunction BookRatingForm({\r\n  rating, setRating, userId, setBook, id, userRated,\r\n}) {\r\n  const { connectedUser, auth } = useUser();\r\n  const navigate = useNavigate();\r\n  const { register, formState, handleSubmit } = useForm({\r\n    mode: 'onChange',\r\n    defaultValues: {\r\n      rating: 0,\r\n    },\r\n  });\r\n  useEffect(() => {\r\n    if (formState.dirtyFields.rating) {\r\n      const rate = document.querySelector('input[name=\"rating\"]:checked').value;\r\n      setRating(parseInt(rate, 10));\r\n      formState.dirtyFields.rating = false;\r\n    }\r\n  }, [formState]);\r\n  const onSubmit = async () => {\r\n    if (!connectedUser || !auth) {\r\n      navigate(APP_ROUTES.SIGN_IN);\r\n    }\r\n    const update = await rateBook(id, userId, rating);\r\n    console.log(update);\r\n    if (update) {\r\n      // eslint-disable-next-line no-underscore-dangle\r\n      setBook({ ...update, id: update._id });\r\n    } else {\r\n      alert(update);\r\n    }\r\n  };\r\n  return (\r\n    <div className={styles.BookRatingForm}>\r\n      <form onSubmit={handleSubmit(onSubmit)}>\r\n        <p>{rating > 0 ? 'Votre Note' : 'Notez cet ouvrage'}</p>\r\n        <div className={styles.Stars}>\r\n          {!userRated ? generateStarsInputs(rating, register) : displayStars(rating)}\r\n        </div>\r\n        {!userRated ? <button type=\"submit\">Valider</button> : null}\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nBookRatingForm.propTypes = {\r\n  rating: PropTypes.number.isRequired,\r\n  setRating: PropTypes.func.isRequired,\r\n  userId: PropTypes.string.isRequired,\r\n  setBook: PropTypes.func.isRequired,\r\n  id: PropTypes.string.isRequired,\r\n  userRated: PropTypes.bool.isRequired,\r\n};\r\n\r\nexport default BookRatingForm;\r\n","C:\\Users\\VINNY\\Desktop\\P6\\OPENCLASSROOMS_P6\\frontend\\src\\lib\\functions.jsx",[],[],{"ruleId":"123","severity":1,"message":"124","line":49,"column":6,"nodeType":"125","endLine":49,"endColumn":26,"suggestions":"126"},{"ruleId":"123","severity":1,"message":"127","line":49,"column":7,"nodeType":"128","endLine":49,"endColumn":25},{"ruleId":"123","severity":1,"message":"129","line":23,"column":6,"nodeType":"125","endLine":23,"endColumn":19,"suggestions":"130"},{"ruleId":"123","severity":1,"message":"131","line":32,"column":6,"nodeType":"125","endLine":32,"endColumn":8,"suggestions":"132"},{"ruleId":"123","severity":1,"message":"133","line":48,"column":6,"nodeType":"125","endLine":48,"endColumn":25,"suggestions":"134"},{"ruleId":"135","severity":2,"message":"136","line":55,"column":19,"nodeType":"137","messageId":"138","endLine":55,"endColumn":26,"suppressions":"139"},{"ruleId":"123","severity":1,"message":"129","line":20,"column":6,"nodeType":"125","endLine":20,"endColumn":19,"suggestions":"140"},{"ruleId":"123","severity":1,"message":"141","line":30,"column":6,"nodeType":"125","endLine":30,"endColumn":12,"suggestions":"142"},{"ruleId":"123","severity":1,"message":"143","line":44,"column":6,"nodeType":"125","endLine":44,"endColumn":17,"suggestions":"144"},{"ruleId":"123","severity":1,"message":"145","line":28,"column":6,"nodeType":"125","endLine":28,"endColumn":17,"suggestions":"146"},"react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'file' and 'imgSrc'. Either include them or remove the dependency array.","ArrayExpression",["147"],"React Hook useEffect has a complex expression in the dependency array. Extract it to a separate variable so it can be statically checked.","ChainExpression","React Hook useEffect has missing dependencies: 'auth', 'connectedUser', and 'navigate'. Either include them or remove the dependency array.",["148"],"React Hook useEffect has a missing dependency: 'params.id'. Either include it or remove the dependency array.",["149"],"React Hook useEffect has a missing dependency: 'connectedUser'. Either include it or remove the dependency array.",["150"],"no-restricted-globals","Unexpected use of 'confirm'.","Identifier","defaultMessage",["151"],["152"],"React Hook useEffect has a missing dependency: 'reset'. Either include it or remove the dependency array.",["153"],"React Hook useEffect has a missing dependency: 'book'. Either include it or remove the dependency array.",["154"],"React Hook useEffect has a missing dependency: 'setRating'. Either include it or remove the dependency array. If 'setRating' changes too often, find the parent component that defines it and wrap that definition in useCallback.",["155"],{"desc":"156","fix":"157"},{"desc":"158","fix":"159"},{"desc":"160","fix":"161"},{"desc":"162","fix":"163"},{"kind":"164","justification":"165"},{"desc":"158","fix":"166"},{"desc":"167","fix":"168"},{"desc":"169","fix":"170"},{"desc":"171","fix":"172"},"Update the dependencies array to be: [file, imgSrc]",{"range":"173","text":"174"},"Update the dependencies array to be: [auth, connectedUser, navigate, userLoading]",{"range":"175","text":"176"},"Update the dependencies array to be: [params.id]",{"range":"177","text":"178"},"Update the dependencies array to be: [book, connectedUser, userLoading]",{"range":"179","text":"180"},"directive","",{"range":"181","text":"176"},"Update the dependencies array to be: [book, reset]",{"range":"182","text":"183"},"Update the dependencies array to be: [book, formState]",{"range":"184","text":"185"},"Update the dependencies array to be: [formState, setRating]",{"range":"186","text":"187"},[1328,1348],"[file, imgSrc]",[882,895],"[auth, connectedUser, navigate, userLoading]",[1078,1080],"[params.id]",[1647,1666],"[book, connectedUser, userLoading]",[746,759],[1069,1075],"[book, reset]",[1481,1492],"[book, formState]",[1010,1021],"[formState, setRating]"]