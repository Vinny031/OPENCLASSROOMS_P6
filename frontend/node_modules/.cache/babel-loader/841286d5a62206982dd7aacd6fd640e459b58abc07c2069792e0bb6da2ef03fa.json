{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/VINNY/Desktop/P6/OPENCLASSROOMS_P6/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/VINNY/Desktop/P6/OPENCLASSROOMS_P6/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/VINNY/Desktop/P6/OPENCLASSROOMS_P6/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import{API_ROUTES,APP_ROUTES}from'../../utils/constants';import{useUser}from'../../lib/customHooks';import{storeInLocalStorage}from'../../lib/common';import{ReactComponent as Logo}from'../../images/Logo.svg';import styles from'./SignIn.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function SignIn(_ref){var setUser=_ref.setUser;var navigate=useNavigate();var _useUser=useUser(),user=_useUser.user,authenticated=_useUser.authenticated;if(user||authenticated){navigate(APP_ROUTES.DASHBOARD);}var _useState=useState(''),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState({error:false,message:''}),_useState8=_slicedToArray(_useState7,2),notification=_useState8[0],setNotification=_useState8[1];var signIn=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _response$data,response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setIsLoading(true);_context.next=4;return axios({method:'post',url:API_ROUTES.SIGN_IN,data:{email:email,password:password}});case 4:response=_context.sent;if(!(response!==null&&response!==void 0&&(_response$data=response.data)!==null&&_response$data!==void 0&&_response$data.token)){setNotification({error:true,message:'Une erreur est survenue'});console.log('Something went wrong during signing in: ',response);}else{storeInLocalStorage(response.data.token,response.data.userId);setUser(response.data);navigate('/');}_context.next=13;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log(_context.t0);setNotification({error:true,message:_context.t0.message});console.log('Some error occured during signing in: ',_context.t0);case 13:_context.prev=13;setIsLoading(false);return _context.finish(13);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,8,13,16]]);}));return function signIn(){return _ref2.apply(this,arguments);};}();var signUp=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setIsLoading(true);_context2.next=4;return axios({method:'POST',url:API_ROUTES.SIGN_UP,data:{email:email,password:password}});case 4:response=_context2.sent;if(response!==null&&response!==void 0&&response.data){_context2.next=8;break;}console.log('Something went wrong during signing up: ',response);return _context2.abrupt(\"return\");case 8:setNotification({error:false,message:'Votre compte a bien été créé, vous pouvez vous connecter'});_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);setNotification({error:true,message:_context2.t0.message});console.log('Some error occured during signing up: ',_context2.t0);case 15:_context2.prev=15;setIsLoading(false);return _context2.finish(15);case 18:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11,15,18]]);}));return function signUp(){return _ref3.apply(this,arguments);};}();var errorClass=notification.error?styles.Error:null;return/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(styles.SignIn,\" container\"),children:[/*#__PURE__*/_jsx(Logo,{}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(styles.Notification,\" \").concat(errorClass),children:notification.message.length>0&&/*#__PURE__*/_jsx(\"p\",{children:notification.message})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.Form,children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:email,children:[/*#__PURE__*/_jsx(\"p\",{children:\"Adresse email\"}),/*#__PURE__*/_jsx(\"input\",{className:\"\",type:\"text\",name:\"email\",id:\"email\",value:email,onChange:function onChange(e){setEmail(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"password\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Mot de passe\"}),/*#__PURE__*/_jsx(\"input\",{className:\"border-2 outline-none p-2 rounded-md\",type:\"password\",name:\"password\",id:\"password\",value:password,onChange:function onChange(e){setPassword(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.Submit,children:[/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"\\r flex justify-center\\r p-2 rounded-md w-1/2 self-center\\r bg-gray-800  text-white hover:bg-gray-800\",onClick:signIn,children:[isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"\"}):null,/*#__PURE__*/_jsx(\"span\",{children:\"Se connecter\"})]}),/*#__PURE__*/_jsx(\"span\",{children:\"OU\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"\\r flex justify-center\\r p-2 rounded-md w-1/2 self-center\\r bg-gray-800  text-white hover:bg-gray-800\",onClick:signUp,children:[isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"mr-2 w-5 h-5 border-l-2 rounded-full animate-spin\"}):null,/*#__PURE__*/_jsx(\"span\",{children:'S\\'inscrire'})]})]})]})]});}export default SignIn;","map":{"version":3,"names":["React","useState","axios","useNavigate","API_ROUTES","APP_ROUTES","useUser","storeInLocalStorage","ReactComponent","Logo","styles","SignIn","setUser","navigate","user","authenticated","DASHBOARD","email","setEmail","password","setPassword","isLoading","setIsLoading","error","message","notification","setNotification","signIn","method","url","SIGN_IN","data","response","token","console","log","userId","signUp","SIGN_UP","errorClass","Error","Notification","length","Form","e","target","value","Submit"],"sources":["C:/Users/VINNY/Desktop/P6/OPENCLASSROOMS_P6/frontend/src/pages/SignIn/SignIn.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport axios from 'axios';\r\nimport * as PropTypes from 'prop-types';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { API_ROUTES, APP_ROUTES } from '../../utils/constants';\r\nimport { useUser } from '../../lib/customHooks';\r\nimport { storeInLocalStorage } from '../../lib/common';\r\nimport { ReactComponent as Logo } from '../../images/Logo.svg';\r\nimport styles from './SignIn.module.css';\r\n\r\nfunction SignIn({ setUser }) {\r\n  const navigate = useNavigate();\r\n  const { user, authenticated } = useUser();\r\n  if (user || authenticated) {\r\n    navigate(APP_ROUTES.DASHBOARD);\r\n  }\r\n\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [notification, setNotification] = useState({ error: false, message: '' });\r\n  const signIn = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const response = await axios({\r\n        method: 'post',\r\n        url: API_ROUTES.SIGN_IN,\r\n        data: {\r\n          email,\r\n          password,\r\n        },\r\n      });\r\n      if (!response?.data?.token) {\r\n        setNotification({ error: true, message: 'Une erreur est survenue' });\r\n        console.log('Something went wrong during signing in: ', response);\r\n      } else {\r\n        storeInLocalStorage(response.data.token, response.data.userId);\r\n        setUser(response.data);\r\n        navigate('/');\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n      setNotification({ error: true, message: err.message });\r\n      console.log('Some error occured during signing in: ', err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const signUp = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const response = await axios({\r\n        method: 'POST',\r\n        url: API_ROUTES.SIGN_UP,\r\n        data: {\r\n          email,\r\n          password,\r\n        },\r\n      });\r\n      if (!response?.data) {\r\n        console.log('Something went wrong during signing up: ', response);\r\n        return;\r\n      }\r\n      setNotification({ error: false, message: 'Votre compte a bien été créé, vous pouvez vous connecter' });\r\n    } catch (err) {\r\n      setNotification({ error: true, message: err.message });\r\n      console.log('Some error occured during signing up: ', err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n  const errorClass = notification.error ? styles.Error : null;\r\n  return (\r\n    <div className={`${styles.SignIn} container`}>\r\n      <Logo />\r\n      <div className={`${styles.Notification} ${errorClass}`}>\r\n        {notification.message.length > 0 && <p>{notification.message}</p>}\r\n      </div>\r\n      <div className={styles.Form}>\r\n        <label htmlFor={email}>\r\n          <p>Adresse email</p>\r\n          <input\r\n            className=\"\"\r\n            type=\"text\"\r\n            name=\"email\"\r\n            id=\"email\"\r\n            value={email}\r\n            onChange={(e) => { setEmail(e.target.value); }}\r\n          />\r\n        </label>\r\n        <label htmlFor=\"password\">\r\n          <p>Mot de passe</p>\r\n          <input\r\n            className=\"border-2 outline-none p-2 rounded-md\"\r\n            type=\"password\"\r\n            name=\"password\"\r\n            id=\"password\"\r\n            value={password}\r\n            onChange={(e) => { setPassword(e.target.value); }}\r\n          />\r\n        </label>\r\n        <div className={styles.Submit}>\r\n          <button\r\n            type=\"submit\"\r\n            className=\"\r\n            flex justify-center\r\n            p-2 rounded-md w-1/2 self-center\r\n            bg-gray-800  text-white hover:bg-gray-800\"\r\n            onClick={signIn}\r\n          >\r\n            {isLoading ? <div className=\"\" /> : null}\r\n            <span>\r\n              Se connecter\r\n            </span>\r\n          </button>\r\n          <span>OU</span>\r\n          <button\r\n            type=\"submit\"\r\n            className=\"\r\n            flex justify-center\r\n            p-2 rounded-md w-1/2 self-center\r\n            bg-gray-800  text-white hover:bg-gray-800\"\r\n            onClick={signUp}\r\n          >\r\n            {\r\n                isLoading\r\n                  ? <div className=\"mr-2 w-5 h-5 border-l-2 rounded-full animate-spin\" /> : null\r\n              }\r\n            <span>\r\n              {'S\\'inscrire'}\r\n            </span>\r\n          </button>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nSignIn.propTypes = {\r\n  setUser: PropTypes.func.isRequired,\r\n};\r\nexport default SignIn;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}